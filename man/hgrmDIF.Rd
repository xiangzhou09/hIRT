% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hgrmDIF.R
\name{hgrmDIF}
\alias{hgrmDIF}
\title{Test Differential Item Functioning in Hierarchical Graded Response Models}
\usage{
hgrmDIF(
  y,
  x = NULL,
  z = NULL,
  x0,
  items_dif = 1L,
  form_dif = c("uniform", "non-uniform"),
  constr = c("latent_scale"),
  beta_set = 1L,
  sign_set = TRUE,
  init = c("naive", "glm", "irt"),
  control = list()
)
}
\arguments{
\item{y}{A data frame or matrix of item responses.}

\item{x}{An optional model matrix, including the intercept term, that predicts the
mean of the latent preference. If not supplied, only the intercept term is included.}

\item{z}{An optional model matrix, including the intercept term, that predicts the
variance of the latent preference. If not supplied, only the intercept term is included.}

\item{x0}{A matrix specifying the covariates by which differential item functioning operates.}

\item{items_dif}{The indices of the items for which differential item functioning is tested.}

\item{form_dif}{Form of differential item functioning being tested. Either "uniform" or "non-uniform."}

\item{constr}{The type of constraints used to identify the model: "latent_scale",
or "items". The default, "latent_scale" constrains the mean of latent preferences
to zero and the geometric mean of prior variance to one; "items" places constraints
on item parameters instead and sets the mean of item difficulty parameters to zero
and the geometric mean of the discrimination parameters to one. Currently, only "latent_scale"
is supported in hgrmDIF().}

\item{beta_set}{The index of the item for which the discrimination parameter is
restricted to be positive (or negative). It may take any integer value from
1 to \code{ncol(y)}.}

\item{sign_set}{Logical. Should the discrimination parameter of
the corresponding item (indexed by \code{beta_set}) be positive
(if \code{TRUE}) or negative (if \code{FALSE})?}

\item{init}{A character string indicating how item parameters are initialized. It can be
"naive", "glm", or "irt".}

\item{control}{A list of control values
\describe{
 \item{max_iter}{The maximum number of iterations of the EM algorithm.
   The default is 150.}
 \item{eps}{Tolerance parameter used to determine convergence of the
  EM algorithm. Specifically, iterations continue until the Euclidean
  distance between \eqn{\beta_{n}} and \eqn{\beta_{n-1}} falls under \code{eps},
  where \eqn{\beta} is the vector of item discrimination parameters.
  \code{eps}=1e-4 by default.}
 \item{max_iter2}{The maximum number of iterations of the conditional
   maximization procedures for updating \eqn{\gamma} and \eqn{\lambda}.
   The default is 15.}
 \item{eps2}{Tolerance parameter used to determine convergence of the
   conditional maximization procedures for updating \eqn{\gamma} and
   \eqn{\lambda}. Specifically, iterations continue until the Euclidean
  distance between two consecutive log likelihoods falls under \code{eps2}.
  \code{eps2}=1e-3 by default.}
 \item{K}{Number of Gauss-Legendre quadrature points for the E-step. The default is 21.}
 \item{C}{[-C, C] sets the range of integral in the E-step. \code{C}=3 by default.}
}}
}
\value{
An object of class \code{hgrm}.
 \item{coefficients}{A data frame of parameter estimates, standard errors,
  z values and p values.}
 \item{scores}{A data frame of EAP estimates of latent preferences and
  their approximate standard errors.}
 \item{vcov}{Variance-covariance matrix of parameter estimates.}
 \item{log_Lik}{The log-likelihood value at convergence.}
 \item{N}{Number of units.}
 \item{J}{Number of items.}
 \item{H}{A vector denoting the number of response categories for each item.}
 \item{ylevels}{A list showing the levels of the factorized response categories.}
 \item{p}{The number of predictors for the mean equation.}
 \item{q}{The number of predictors for the variance equation.}
 \item{p0}{The number of predictors for items with DIF.}
 \item{coef_item}{Item coefficient estimates.}
 \item{control}{List of control values.}
 \item{call}{The matched call.}
}
\description{
\code{hgrmDIF} fits a hierarchical graded response model similar to hgrm(), but person-specific
covariates \code{x} are allowed to affect item responses directly (not via the latent preference).
This model can be used to test for the presence of differential item functioning.
}
\examples{
y <- nes_econ2008[, -(1:3)]
x <- model.matrix( ~ party * educ, nes_econ2008)
nes_m2 <- hgrmDIF(y, x, items_dif = 1:2)
coef_item(nes_m2)
}
